@using Microsoft.AspNet.Identity
@if (Request.IsAuthenticated)
{
    string userName = User.Identity.GetUserName();

    <!-- Menu Toggle Button -->
    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
        <!-- The user image in the navbar-->
        <img src="~/img/user2-160x160.jpg" class="user-image" alt="User Image">
        <!-- hidden-xs hides the username on small devices so only the image appears. -->
        <span class="hidden-xs">@userName</span>
    </a>

    <ul class="dropdown-menu">
        <!-- The user image in the menu -->
        <li class="user-header" style="height: unset">
            <img src="~/img/user2-160x160.jpg" class="img-circle" alt="User Image">
            <p>@userName</p>
        </li>
        <!-- Menu Footer-->
        <li class="user-footer">
            <div class="pull-left">
                @Html.ActionLink("Profile", "Index", "Members", routeValues: new { username = userName }, htmlAttributes: new { @class = "btn btn-default btn-flat" })
            </div>
            <div class="pull-right">
                @using (Html.BeginForm("LogOff", "Account", FormMethod.Post, new { id = "signOutForm" }))
                {
                    @Html.AntiForgeryToken()
                    <a href="javascript:document.getElementById('signOutForm').submit()" class="btn btn-default btn-flat">Sign out</a>
                }
            </div>
        </li>
    </ul>
}
else
{
    <!-- hidden-xs hides the username on small devices so only the image appears. -->
    @Html.ActionLink("Log in", "Login", "Account", routeValues: null, htmlAttributes: new { id = "loginLink", @class = "hidden-xs" })
}
